
Sub PatentAppNoModified(applicationNumber)

'delete ""  "/" in applicationNumber

    applicationNumber = Replace(Replace(applicationNumber, " ", ""), ".", "")
        
End Sub

Function PatentAppNoCheckBit(applicationNumber)   '专利申请号校验位

    Dim LengthOfAppNumber, TypeOfAppNumber As Byte
    Dim ArrAppNo()
    Dim sum, i As Integer
    
    i = 1
    sum = 0
    
    CheckBitSequence = Array(2, 3, 4, 5, 6, 7, 8, 9, 2, 3, 4, 5)
    
        TypeOfAppNumber = VarType(applicationNumber)
        LengthOfAppNumber = Len(applicationNumber) - 1 '形参aaplicationNumber是13位的专利号，最后一位是检验位，只需要取前12位
            
        ReDim ArrAppNo(1 To LengthOfAppNumber)
            
            For i = 1 To LengthOfAppNumber Step 1
            
                ArrAppNo(i) = CInt(Mid(applicationNumber, i, 1))
                sum = sum + ArrAppNo(i) * CheckBitSequence(i - 1)   'CheckBitSequence下标从0开始，for循环的i从1开始，故（i-1)
                
            Next i
            
        PatentAppNoCheckBit = sum Mod 11
        
        If (PatentAppNoCheckBit >= 10) Then
        
            PatentAppNoCheckBit = "X"
        
        End If
        
End Function

Function IDentityCheckbit(IDentityNumbers)          '中国公民身份证号校验位,18位

    Dim LengthOfIDentityNumbers, TypeOfIDentityNumbers, remainder, i As Byte
    i = 1
    Dim ArrIDentityNumbers()
    Dim sum  As Integer
    sum = 0
    
    IDCardCheckBitSequence = Array(7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2)
    IDCardCheckBitResult = Array(1, 0, x, 9, 8, 7, 6, 5, 4, 3, 2)
    
        TypeOfIDentityNumbers = VarType(IDentityNumbers)
        LengthOfIDentityNumbers = Len(IDentityNumbers) - 1 '形参IDentityNo是18位的身份证号，最后一位是检验位，只需要取前17位
            
        ReDim ArrIDentityNumbers(1 To LengthOfIDentityNumbers)
            
            For i = 1 To LengthOfIDentityNumbers Step 1
            
                ArrIDentityNumbers(i) = CInt(Mid(IDentityNumbers, i, 1))
                sum = sum + ArrIDentityNumbers(i) * IDCardCheckBitSequence(i - 1)   'IDCardCheckBitSequence下标从0开始，for循环的i从1开始，故（i-1)
                
            Next i
            
        remainder = sum Mod 11
        
        IDentityCheckbit = IDCardCheckBitResult(remainder)       '取模运算得到余数remainder，把remainder作为数组IDCardCheckBitResult的索引，即可得到身份证号的校验位数值
        
        If remainder = 2 Then
        
            IDentityCheckbit = "X"
        
        End If
 
End Function
